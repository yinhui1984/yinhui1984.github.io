---
title: "IPFS和朋友们"
date: 2022-10-20T16:28:32+08:00
draft: true
author: yinhui
categories: [Blockchain]
tags: [IPFS, L1,Web3.0] 
---





IPFS和朋友们: 下一代点对点数据网络的定性比较.

Erik Daniel and Florian Tschorsch

https://arxiv.org/pdf/2201.05286.pdf

摘要--分散的分布式存储为减少数据孤岛的影响提供了一种方法，因为集中式云存储往往会助长这种影响。虽然这种趋势的意图并不新鲜，但由于技术的进步，特别是区块链网络的发展，这个话题得到了牵引。因此，我们观察到，新一代的点对点数据网络出现了。因此，在这篇调查报告中，我们对下一代数据网络进行了技术概述。我们使用选定的数据网络来介绍一般概念，并强调新的发展。具体来说，我们提供了星际文件系统的更深入的概要，以及Swarm、Hypercore Protocol、SAFE、Storj和Arweave的总体概述。我们确定了共同的构建模块，并提供了一个定性的比较。从概述中，我们得出了有关数据网络的未来挑战和研究目标。
索引词--数据网络，区块链网络，点对点网络，叠加网络



<!--more-->

## 介绍

如今，用户以这种或那种方式通过使用云存储供应商来存储和共享数据。云存储是集中组织的，其中存储基础设施通常由一个单一的逻辑实体拥有和管理。这种云存储供应商负责存储、定位、提供和保护数据。虽然云存储可以有很多经济和技术上的优势，但它也引起了一系列的担忧。集中的控制和治理导致了可能影响可访问性、可用性和保密性的数据孤岛。例如，数据访问可能会受到审查的影响。同时，数据孤岛构成了一个有价值的漏洞和获取数据出售的目标，这对安全和隐私构成了威胁。一般来说，用户失去了自我决定的控制权，而将其委托给云计算供应商。

摆脱数据孤岛和减少信任假设的一个方向是点对点数据网络。这个术语概括了一系列的数据存储方法，它们建立在对等（P2P）网络的基础上，包括数据存储、复制、分发和交换等方面。作为P2P网络的典型，peers直接互动，建立一个覆盖网络，共享资源，并可以做出自主的本地决定。因此，P2P数据网络致力于共同管理和共享存储。虽然P2P网络的主要目标和原则在过去20年中没有改变，但P2P网络随着时间的推移不断发展，改进了可用性和功能。在图1中，我们说明了从第一代到下一代数据网络的发展。

### A. 第一代数据网络

有许多不同的老式P2P网络，也可以归类为数据网络。P2P技术的普及是在1999年随着音频文件共享网络Napster出现的，紧随其后的是用于共享所有类型文件的Gnutella[1]。Napster和Gnutella标志着一个开端，随后许多其他P2P网络集中于专门的应用领域或新颖的网络结构。例如，Freenet[2]实现了匿名存储和检索。Chord[3]、CAN[4]和Pastry[5]提供了维护结构化叠加网络拓扑的协议。特别是，BitTorrent[6]受到了用户和研究界的广泛关注。BitTorrent引入了一种激励机制来实现帕累托效率，试图提高网络利用率达到更高的稳健性。我们认为Napster、Gnutella、Freenet、BitTorrent等网络是第一代P2P数据网络，它们主要关注文件共享。
Androutsellis-Theotokis和Spinellis[7]提供了2004年P2P内容分发技术的现状，对前一代技术进行了广泛的介绍。以前的其他作品也对前一代产品进行了更仔细的研究，更关注特定的P2P数据网络（如FreeNet和Past）[8, 9]或一般的分散文件系统（如Google FS和Hadoop Distributed FS）[10]。
P2P技术的进步和这种第一代数据网络的普及，影响了分布式文件系统[8]和内容分发技术[7]的领域。这种趋势也属于一般的数据网络，特别是P2P数据网络的范畴。

### B. 过度阶段

P2P文件共享系统中似乎缺少一个组成部分，那就是提高文件的长期存储和可用性的方法。随着2008年比特币[11]的问世，P2P理念，尤其是联合数据复制获得了新的发展。分布式账本技术在分布式系统中提供了可用性、完整性和拜占庭容错性。特别是，加密货币显示了其在去中心化环境中作为货币激励机制的潜力。这些和其他的趋势和发展，例如Kademlia[12]和以信息为中心的网络[13]，导致了我们发明了下一代的P2P数据网络。

### C. 下一代数据网络

从2014年IPFS[14]的推出开始，我们将下一代数据网络定义为过去十年出现的去中心化的数据共享和存储的系统和概念。我们提供了这个下一代P2P数据网络的技术概述。与现有文献相比，我们对下一代数据网络，即P2P数据网络进行了比较概述。我们专注于独立于区块链的利用的存储和内容共享。

在本文中，我们展示了这些新系统是如何建立的，它们如何利用从以前的系统中获得的知识，以及过去十年的新发展和进步。我们确定了这些系统的构建块、相似性和趋势。虽然有些系统本身就是其他应用的构件，例如去中心化的应用（DApps），但我们专注于两个主要的系统方面：内容分发和分布式存储。此外，我们还提供了对激励机制的见解，部署在检索或存储文件，或两者兼而有之。由于许多新的数据网络被开发出来，我们不能提供所有数据网络的全面概述。相反，我们专注于一些具有复杂或独特机制的精选系统，不同的使用案例，以及不同程度的内容和用户隐私。我们的概述侧重于概念，并从实施细节中抽象出来，以提取一般的见解。然而，应该注意的是，由于正在进行的开发，这些系统很容易发生变化。我们的调查报告利用了广泛的来源，包括同行评议的论文、白皮书以及文档、规范和源代码。

具体来说，我们关注IPFS[14]、Swarm[15]、Hypercore协议[16]、SAFE[17]、Storj[18]和Arweave[19]。特别是，InterPlanetary File System（IPFS）作为区块链的存储层已经得到了普及[20-26]，并且是一系列研究的主题[27-37]。此外，我们将这些系统的概述与之前的系统和研究方向，即BitTorrent、以信息为中心的网络和区块链放在一起。通过对比前驱系统，我们勾勒出数据网络的演变，并能够深刻地讨论下一代的进步。
基于这一概述，我们提取了P2P数据网络的构建模块和一些独特的方面。虽然所有系统都允许分布式内容共享和存储，但它们似乎都集中在其中一个方面。也就是说，每个系统的目的略有不同，要求和关注点也不同。这导致了在网络组织、文件查询、分散程度、冗余度和隐私方面的不同设计决定。例如，Storj的目标是分布式云存储，而Hypercore协议的重点是分布大型数据集。同样，IPFS旨在取代网络的客户端-服务器结构，因此需要比BitTorrent更关注数据查询，因为BitTorrent主要是将每个文件放在自己的覆盖网络中。同时，我们发现在构建数据网络的方法上有许多相似之处，例如，使用Kademlia来构建网络或寻找对等人，将文件分割成碎片，或激励不同的任务来增加功能。

其他关于下一代数据网络的研究特别关注与区块链的互动。Huang等人[38]主要涉及IPFS和Swarm，Benisi等人[39]讨论这些技术时更注重区块链方面。Casino等人[40]仔细研究了去中心化存储的不可更改性及其后果和可能的威胁。然而，一些数据网络由于可扩展性或延迟问题，明确决定反对使用区块链。因此，在我们的调查报告中，我们从更广泛的角度来看待数据网络，关注区块链之外的数据网络的设计决策。

Naik和Keshavamurthy[41]对最近的P2P网络给出了一个更普遍的观点。他们描述了下一级P2P网络，BitTorrent和Chord等经典网络的演变，并讨论了流失率下的性能问题。应该注意的是，他们对下一代网络的定义与我们对下一代的定义不同，因为他们把IPFS定义为 "经典的P2P网络"。相反，我们认为，P2P数据网络随着时间的推移而发展，融入了新建立的领域的想法，例如，明确的激励机制。

其余部分的结构如下。调查从系统观点过渡到数据网络的研究观点，而不是组件观点。作为系统观点的一部分，我们首先提供了数据网络的技术先驱的背景信息（第二节）。随后，我们介绍了 "IPFS和朋友"，并提供了下一代数据网络的详细技术概述（第三节和第四节）。最后，我们提到相关的系统和概念（第IV-F节）。作为组件观点的一部分，我们推导出数据网络的构件，并分享从技术概述中获得的见解（第五节）。最后，我们过渡到研究视角，并确定研究领域和开放的挑战（第六节）。第七部分是本调查的结论。

<img src="https://github.com/yinhui1984/imagehosting/blob/main/images/1666145476483309000-Snipaste_2022-10-19_10-10-14.jpg?raw=false" alt="image" style="zoom:50%;" />





## 前驱技术

自P2P数据网络首次出现以来，已经有二十多年了。在此期间，该技术不断发展，并影响了新网络的发展。我们观察到，P2P数据网络基本上有三个 "时代"。首先是1999-2002年的P2P文件共享和网络，如BitTorrent和Kademlia，我们认为这是第一代。这个时代之后是 "过渡阶段"，出现了以信息为中心的网络和加密货币等新思想。大约从2014年起，随着IPFS的发明，我们看到新一代的P2P数据网络逐渐受到重视。为了更好地理解和欣赏这些影响因素，我们提供了一个介绍，即BitTorrent、Kademlia、以信息为中心的网络、自我认证的名称和区块链等重要的 "前驱 "技术铺垫。

### A. BitTorrent

BitTorrent协议[6]是一个P2P文件共享协议。它有一个控制下载行为的激励结构，试图实现公平的资源消耗。BitTorrent的目标是提供一种比使用单一服务器更有效的方式来分发文件。这是通过利用文件在每次下载时被复制的事实来实现的，使文件分发具有自我扩展性。

文件以torrents的形式进行交换。一般来说，每个torrent是一个P2P覆盖网络，负责一个文件。为了用BitTorrent协议交换一个文件，需要创建一个.torrent文件，其中包含文件的元数据和一个联络点，即一个跟踪器。也可以在一个.torrent文件中定义多个文件。在文件被共享之前，torrent文件需要被提供，例如在一个网络服务器上。跟踪器作为torrent的引导节点。拥有完整文件的对等体被称为播种者。那些仍然错过大块文件(chunks)的对等者被称为租赁者。Leechers要求获取文件块并同时作为已经下载的文件块的下载点。

图2是BitTorrent如何处理文件的概念性概述，可以看出。这些角色及其相互作用如下：一个对等体得到.torrent文件，联系.torrent文件中列出的跟踪者𝑇，得到一个对等体的列表，连接到对等体并成为一个租赁者。在图中，对等体𝑆0作为文件的种子，对等体𝐿𝑖代表请求不同块的租赁者。如图所示，在.torrent文件中，该文件被分割成若干块𝑐𝑗。在一个泄密者成功获得所有的块之后，它就成为一个新的种子。种子𝑆0和租借者为该文件建立torrent网络。其他文件则分布在不同的torrent网络中，可能有不同的对等人。

除了所提出的集中式跟踪器之外，还有无跟踪器的torrent。在无追踪器的torrent中，种子是通过分布式哈希表（DHT）找到的。客户端从torrent文件中获得密钥，DHT返回torrent的可用对等体列表。BitTorrent客户端可以使用预先确定的节点或由torrent文件提供的节点来引导DHT.

<img src="https://github.com/yinhui1984/imagehosting/blob/main/images/1666147407873820000-Snipaste_2022-10-19_10-43-00.jpg?raw=false" alt="image" style="zoom:50%;" />

使BitTorrent独特（可能也是成功的）的特点是明确激励对等人交换数据，这在文件共享策略中实现了最稀有的一块第一和针锋相对。最稀有的片段首先描述了BitTorrent的块选择。它可以确保最大限度地减少数据块的重叠，使文件交换对节点的流失更加有力。在网络中最不常见的块被优先选择用于下载。针锋相对 "描述了带宽资源分配机制。在BitTorrent中，对等人根据从对等人那里下载的数据来决定他们向谁上传数据。这应该可以防止勒索者只下载而不提供任何资源给其他人。
BitTorrent被研究得很好[42-44]，并且已经证明了它的时间考验。尽管它年代久远，但仍有数百万人[45]积极使用它来分享文件，也是新的点对点文件分发系统的典范。此外，BitTorrent基金会和Tron基金会开发了BitTorrent Token（BTT）[46]，它作为一个基于区块链的激励层，提高了文件的可用性和持久性。新的激励结构通过投标数据扩展了针锋相对。出价数据决定BTT/字节率，对等体为持续服务支付BTT。作为付款的交换，对等体是畅通无阻(unchoked)，有资格接收数据。token的交换由一个支付渠道处理。



### B. Kademlia (卡德米利亚协议)

从今天的角度来看，Kademlia[12]可能是使用最广泛的DHT。我们将在后面看到，大多数P2P数据网络都以这种或那种方式建立在Kademlia之上。Kademlia也影响了P2P文件交换的协议，比如BitTorrent，它通过使用基于Kademlia的DHT实现了无跟踪的torrent [47]。

一般来说，Kademlia可以被归类为结构化覆盖网络，它规定了如何结构化和维护P2P网络。为此，对等体被分配了一个身份，这决定了它的位置，从而决定了它的邻居。对于邻居的选择，采用的是XOR度量。XOR度量的优点是它是对称的和单向的。根据它们的XOR距离，节点被分类到𝑘桶中。桶被安排为二进制树，其中最短的前缀决定了桶的位置。如果一个新的节点属于一个包含𝑘节点（包括它自己）的桶，该桶就会被分割成更小的桶，否则新的节点就会被放弃。图3显示了一个具有8位标识符的示例性Kademlia树。

<img src="https://github.com/yinhui1984/imagehosting/blob/main/images/1666147847394933000-Snipaste_2022-10-19_10-50-31.jpg?raw=true" alt="image" style="zoom:50%;" />



### C. ICN (信息中心网络)

另一个值得一提的先驱是信息中心网络（ICN）。尽管ICN不是一个P2P数据网络，但它的一些想法和概念至少与一些数据网络相似。与P2P数据网络相反，ICN建议改变网络层。数据包的路由和流动应该从点对点的位置搜索改变为直接从网络上请求内容。作为一个例子，让我们假设我们想检索一些数据，例如一个网站，并且我们知道这个网站在example.com上。首先，我们通过DNS请求该网站的主机位置，即IP地址。之后，我们建立一个连接来检索该网站。在ICN中，我们会直接请求数据，而不会对数据所在的主机进行寻址。任何存储网站的节点都可以立即提供数据。

Jacobson等人[48]提出以内容为中心的网络，这些内容请求是兴趣包。然后，内容的所有者可以用包含内容的数据包直接回答兴趣包。这需要在基础设施层面上的流量控制、路由和安全等其他机制。兴趣包被广播，分享数据兴趣的对等体可以共享资源。有多个项目在处理ICN，例如，命名数据网络[49]（NDN）。通过Ntorrent[50]，Mastorakis等人提出了一个NDN的扩展，在NDN中实现类似BitTorrent的机制。关于ICN的进一步一般信息可以在[13]中找到。由于数据网络以内容为中心的性质，它们可以被广泛地解释为ICN的叠加实现。



### D. Self-Certifying Names

从以主机为中心的通信到以内容为中心的通信的变化引入了新的安全问题。此外，随着缓存成为网络的一个主要特征，需要考虑特定的威胁，例如缓存中毒或针对缓存的拒绝服务攻击。更广泛地说，ICN的安全问题一般包括内容认证、授权和访问控制，以及隐私[51]。

目前，安全研究的主要焦点在于认证。由于缓存的广泛使用，数据提供者不一定是一个对象的原始来源（数据所有者）了。这就需要建立机制，使接收者能够评估对象的有效性（完整性）、来源（内容来源）和相关性。

确保有效性和相关性的一种方法是Self-Certifying Names。通过使用散列指针（或更一般的内容散列）来引用内容，可以启用Self-Certifying Names。一个文件的内容被用作加密哈希函数的输入，例如SHA-3[52]。由此产生的摘要可以用来识别内容，客户端可以在本地验证文件的完整性。哈希函数的加密特性，最重要的是预像和抗碰撞，确保没有人可以在不改变其摘要的情况下替换或修改输入数据。在这种情况下，名称提供了完整性和相关性，然而，谁负责验证对象，如客户端和/或中间人，仍然是有疑问的。此外，一个Self-Certifying Names本身不能提供出处或证明对象的来源。加密签名可以保证对象来源的真实性，但需要一个公钥基础设施或信任网络来验证签名。虽然这允许验证对象来源的真实性，但仍有可能发送畸形的对象，因此需要机制来确保完整性。通过缓存来延长内容的寿命，需要仔细的密钥管理，以防止密码证书被破坏。
访问控制也有类似的问题：一旦数据被发布，就很难限制访问或撤销发布。加密可以限制访问，但可能需要带外的密钥分配。关于安全、隐私、访问控制和ICN的其他挑战的进一步见解，可以在[53, 54]中找到



### E. 区块链

2008年，比特币[11]的引入为分布式应用带来了新的可能性。比特币是一个巧妙的、错综复杂的组合，它融合了链接时间戳、数字现金、P2P网络、拜占庭容错和密码学等领域的思想[55, 56]。比特币带来的关键创新之一是一个开放的共识算法，积极激励对等人遵守。因此，它使用了硬币的概念，在这个过程中产生，即挖矿。

虽然区块链一词通常指的是整个系统及其协议，但它也指的是一个特定的数据结构，类似于哈希链或哈希树。也就是说，区块链订购的区块用加密哈希值与它们的前辈相连。这种链接的数据结构确保了区块链数据的完整性，例如，交易。区块链的一致性由一个共识算法来保证，例如，在比特币中的中本聪共识。关于比特币和区块链的更多细节，我们参考了[56]。

由于区块链存在可扩展性等问题，人们开发了不同的设计来缓解这些问题。这些不同的设计开辟了一个新的类别，被称为分布式账本技术（DLT）。DLT提供了分布式的、拜占庭容错的、不可变的和有序的日志。不幸的是，由于一系列的可扩展性问题和有限的链上存储容量，纯粹的基于DLT的数据网络的可行性是有限的[57, 58]。此外，在被设计为交换媒介和价值存储的区块链，即比特币等加密货币中存储大量数据，会导致高额的交易费用。然而，DLT的研究和开发显示了基于区块链的数据网络的可行性，例如Arweave（参见第四节E）。

然而，一般来说，允许去中心化支付的加密货币可以在P2P数据网络中作为一种激励结构使用。正如我们将在下文中阐述的那样，这种激励结构可以提高数据网络的稳健性和可用性，从而解决前几代的弱点



## INTERPLANETARY FILE SYSTEM (IPFS)

星际文件系统（[IPFS](https://ipfs.tech)）[14]是一个子协议束，也是一个由协议实验室推动的项目。IPFS的目的是提高网络的效率，使网络更加分散和有弹性。**IPFS使用基于内容的寻址，内容不是通过位置而是通过其内容寻址。IPFS存储和寻址数据的方式及其重复数据删除的特性，允许有效地存储数据**。
通过IPFS，有可能以分散的方式存储和共享文件，增加其内容的抗审查性。IPFS可以用来部署网站，建立一个分布式网络。它被用作补充区块链的存储服务，在IPFS之上实现不同的应用。

**由于IPFS使用基于内容的寻址，它主要关注不可变的数据**。然而，**IPFS通过整合InterPlanetary Name System（[IPNS](https://docs.ipfs.tech/concepts/ipns/#mutability-in-ipfs)）支持内容的可更新地址**。IPNS允许将一个名称（公钥的哈希值）与文件的内容标识符联系起来。IPNS条目由私钥签署，可以任意地（重新）发布到网络上（默认为4小时）。每个对等体维护其自己的LRU缓存的解决条目（默认为128个条目）。一个IPNS条目有一个特定的寿命，之后它将从缓存中删除（默认为24小时）。通过改变固定名称到内容标识符的映射，可以实现文件更新。请注意，内容标识符是唯一的，并且是特定的文件。

此外，IPFS采用了自己的激励层，即Filecoin[59]，以确保网络中文件的可用性。然而，IPFS独立于Filecoin工作，反之亦然。这是一个典型的例子，说明如何整合加密货币来激励同行。



### A. 一般功能

IPFS使用模块化的P2P网络栈[libp2p](https://libp2p.io)[60]。事实上，libp2p是在开发IPFS时出现的。在IPFS中，节点是由一个节点ID识别的。节点ID是其公钥的哈希值。为了加入网络，IPFS开发团队部署了一些引导节点。通过联系这些节点，一个对等体可以学习新的对等体。与一个节点相连的对等体，表示为它的蜂群(swarm)。对等体可以通过基于Kademlia的DHT和本地节点发现来找到。连接之间的通信可以是加密的。虽然IPFS使用Kademlia，但其连接并不完全由Kademlia决定。在IPFS中，一个节点与新发现的节点建立连接，试图将它们放入桶中[34]。一旦达到HighWater阈值（默认为900），空闲的连接就会被修剪，直到达到LowWater阈值（默认为600）。如果一个连接没有被明确保护，并且存在的时间超过了宽限期（默认为20𝑠），那么它就被认为是空闲的。受保护的连接是，例如，当前正在使用的连接，明确添加的对等体，或DHT功能所需的对等体。

IPFS中的一个对象（文件、列表、树、提交）被分割成若干块或区块。每个块都可以通过内容标识符（CID）来识别，它可以根据内容的配方来创建。从这些块中，一个Merkle有向无环图（DAG）被创建。Merkle DAG类似于Merkle树。Merkle DAG的每个节点都有一个由该节点的内容确定的标识符。然而，相比之下，Merkle DAG不需要平衡，一个节点可以携带一个有效载荷，而且一个节点可以有多个父节点。Merkle DAG的根可以用来检索文件。IPFS采用了重复数据块：每个存储的块都有不同的CID。这有利于文件的版本划分，即较新的文件版本与较旧的版本共享大量的块。在这种情况下，只需要存储各版本之间的差异，而不是两个完整的Merkle DAGs。这些块有一个附加的包装，指定了块的UNIXFS类型。 

为了说明Merkle DAGs和重复数据删除的机制，让我们假设我们的调查论文和该论文的早期草稿都存储在IPFS上。图4显示了这两个文件的Merkle DAGs的简化表示。每个节点代表一个块，标签代表节点的CID，即内容散列。DAG是自下而上创建的，因为中间节点的CID取决于它的下级。实际数据位于叶子中。在最终版本中，我们假设额外的信息被附加到了内容中，这导致了不同的根节点和额外的节点。因此，在我们的例子中，𝐹是草案的根CID，𝐹′是完成的调查的根。

![image](https://github.com/yinhui1984/imagehosting/blob/main/images/1666149275637938000-Snipaste_2022-10-19_11-14-19.jpg?raw=true)

区块本身存储在设备或供应商上。DHT作为数据提供者的查询工具。如同在Kademlia中，节点id最接近CID的节点存储了内容提供商的信息。一个提供者可以宣布它正在存储特定的块。区块的占有在一个可配置的时间范围内被重新宣布（默认为12小时）。



1. [Bitswap](https://docs.ipfs.tech/concepts/bitswap/): 区块的实际交换是由Bitswap协议处理的。每个节点都有一个 "想要"、"拥有 "和 "不想要 "的列表。不同的列表包含该节点想要/拥有或不想要的CID。不想要的列表中的CID甚至不被缓存，只是在接收时被丢弃。一个节点将其想要的列表上的CIDs发送给它的群组。拥有该区块的邻居会发送该区块和创建CID的recipe。然后，该节点可以通过从recipe中建立CID来验证该内容。如果没有邻居拥有想要的CID，IPFS会进行DHT查询。在DHT查找成功后，拥有该CID的节点被添加到蜂群(swarm)中，并发送想要的列表。
   对于一个对等体来说，要下载一个文件，它需要知道根CID。在获得一个对象的Merkle DAG根的CID后，它可以把这个根CID放在想要的列表上，而之前描述的Bitswap/DHT就会接手。根块给出其节点的信息，导致必须请求新的CID。随后的CID请求不会发送给所有邻居。回答根CID的邻居被优先考虑，并被分组到一个会话中。从0.5版本开始，Bitswap对会话中的多个对等体的后续请求发送WANT-HAVE消息，对一个对等体发送乐观的WANT-BLOCK消息。WANT-HAVE消息询问对等体是否拥有该区块，WANT-BLOCK消息直接请求该区块。如果收到了一个区块，其他悬而未决的请求可以用CANCEL消息取消[36]。以前，邻居同时请求区块，导致可能多次收到一个区块。一旦获得树的所有叶子，文件就可以在本地使用。文件不会被上传到网络上，只有占有被宣布。

   图5说明了一个使用IPFS的典型文件交换。这里，一篇调查报告的作者使用IPFS与审稿人交换。节点身份为𝑁3的作者通过IPFS提供调查报告，IPFS将其分割成Merkle DAG（也见图4）。作者通过带外信道与审稿人分享DAG的结果根CID𝐹。审查者，其节点的身份是𝑁11，从网络上请求𝐹。Bitswap处理交换询问邻居的块，随后请求DAG。由于除了调查的作者之外，没有人能够回答审查者的请求，作者最终使用Bitswap向审查者提供文件。当审查者获得所有区块时，她就会将文件组装起来，并可以阅读调查报告。

   ![image](https://github.com/yinhui1984/imagehosting/blob/main/images/1666159175314574000-Snipaste_2022-10-19_13-59-03.jpg?raw=true)

2) 可用性: IPFS没有任何隐含的机制来修复和维护文件或确保网络的冗余和可用性。在我们前面的例子中，只有作者𝑁3和审稿人𝑁11持有调查的所有块。由于协议的原因，没有主动复制。然而，文件可以被 "钉住" (Pin)，以防止一个节点在本地删除块。否则，内容只被缓存，可以在任何时间点通过垃圾收集删除。此外，文件不能在其他节点上被故意删除，删除总是只发生在本地。对于一个文件的消失，它需要从每个缓存和每个钉子节点中删除。
存在Filecoin[59]来保证存储。Filecoin采用了一个存储和检索市场来存储和检索文件。存储市场负责存储数据，例如，将客户与存储矿工相匹配，并在账本上记录他们的交易，奖励/惩罚存储矿工，并验证持续存储。检索市场负责检索文件。检索矿工提供数据以换取Filecoin，并且只在提供请求时需要数据。为了确保客户和检索矿工这两方都能合作并得到补偿，数据检索是通过支付渠道来保证的，数据被分成小块发送，并在发送下一块数据之前用小额支付进行补偿。
虽然存储和检索市场处理其任务略有不同，但主要原则是相同的。有三种不同的订单：出价，要价，和交易。竞价订单是客户的服务请求，它想存储或检索文件。询问订单是存储或检索节点的服务报价，宣布存储或检索条件。交易订单是关闭买入和卖出订单之间交易的声明。订单被存储在订单簿中。对于存储市场，订单簿存储在链上，以确保客户的知情决策，并告知市场的趋势。订单被添加到清晰的揭示信息中。检索市场的订单簿是链外的，以提高检索速度。
交易的执行是使用具有Proof-of-Replication（PoRep）和Proof-of-Replication（PoST）的分布式账本进行维护。PoRep是一个存储节点复制数据的证明，确保数据存储在独立的物理存储上。PoST证明了随时间推移的连续存储。关于不同证明的更多信息，我们参考了技术报告[61]。



### B. 特征和扩展

IPFS支持多种传输/网络协议，或加密哈希函数，以增加其适应性。这是通过使用多地址和多哈希数据结构实现的。多地址是一种用于编码寻址信息的路径结构。它们允许对等体宣布其联系信息（如IPv4和IPv6）、传输协议（如TCP和UDP）和端口。Multi-hash用于提供多个不同的哈希函数。摘要值的前缀是摘要长度和哈希函数类型。多重哈希被用于节点id和部分CID。

IPFS中的CID是用来识别块的。一个CID是其内容的加密哈希值，并添加了元数据。元数据包括使用的散列算法和它的长度（多散列）、编码格式（行星间关联数据）和版本。更具体的说，用编码信息预加的多重哈希是InterPlanetary Linked Data（IPLD），而用版本信息预加的IPLD是实际的IPFS CID。

**虽然IPFS本身没有确保冗余/可用性的机制，但IPFS Cluster允许创建和管理一个额外的节点叠加网络，与IPFS主网络分开。**IPFS Cluster有助于确保数据冗余和定义的群组中的数据分配。集群管理钉住的数据，维护配置的复制量，必要时重新钉住内容，并在选择钉住数据的节点时考虑自由存储空间。IPFS Cluster需要一个正在运行的IPFS节点。IPFS Cluster使用libp2p作为其网络层。

IPFS Cluster确保了文件的横向可扩展性，没有任何激励措施。它可以被内容提供商用来提高可用性，而不依赖网络中的缓存。FileCoin可以用来激励其他人存储文件。



### C. 用例

在下文中，我们简要介绍了几个有代表性的领域，以展示IPFS的一些使用案例。然而，请注意，这并不是一个详尽的清单，也不是本文的重点。然而，它提供了对数据网络的当前用例和潜力的见解，特别是IPFS。
在许多有关数据交换的领域，IPFS经常与区块链相结合。在这种情况下，区块链可以实现各种目的。区块链可以提供完整性、真实性，或者作为数据的指针。应用范围包括医疗数据[26，62]，跟踪农产品[63]，或一般的物联网（IoT）数据[20]。区块链也可以作为一种机制，为IPFS数据提供访问控制[22, 23, 64]，或为数据提供审计跟踪[31]。一般来说，数据网络也可以用来改善区块链的存储问题，例如，通过脱链交易数据[21]。此外，一些研究人员提出了基于IPFS和区块链的新内容共享机制[24, 25, 65]。另一个提议的用例是使用IPFS公开科学论文，并使用区块链提供与审稿人、审稿和论文相匹配的审查机制[66]。
然而，IPFS也有不涉及区块链的用例。遵照其去中心化互联网的目标，IPFS可用于在InterPlanetary Wayback中对网站进行存档[67]。其他没有区块链的用例是与ICN结合作为内容交付网络[30]，将IPFS与用于Fog/Edge计算的扩展网络附加存储相结合[68]，或者与IPFS集群结合用于存储物联网数据以提高可用性[29]。
最后，也有可能将IPFS滥用于恶意活动，例如，将勒索软件作为一种服务[69]或用于协调僵尸网络[27]。



TODO ....

